---
const showBlog = !!process.env.DATABASE_URL;

const pdfLinks = [
  { href: '/compress-pdf', label: 'Compress PDF' },
  { href: '/merge-pdf', label: 'Merge PDF' },
  { href: '/split-pdf', label: 'Split PDF' },
  { href: '/jpg-to-pdf', label: 'JPG to PDF' },
];

const imageLinks = [
  { href: '/compress-image', label: 'Compress Image' },
  { href: '/resize-image', label: 'Resize Image' },
  { href: '/convert-to-jpg', label: 'Convert to JPG' },
  { href: '/crop-image', label: 'Crop Image' },
  { href: '/remove-background', label: 'Remove BG' },
];
---

<header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b-[3px] border-slate-900">
  <nav class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
    <a href="/" class="flex items-center gap-2">
      <div class="w-8 h-8 bg-indigo-500 rounded-lg border-2 border-slate-900 shadow-[2px_2px_0px_0px_rgba(15,23,42,1)] flex items-center justify-center">
        <span class="text-white font-black text-sm">P</span>
      </div>
      <span class="font-black text-xl text-slate-900 tracking-tight">PrivaTools</span>
    </a>

    <div class="hidden md:flex items-center gap-8">
      <div class="relative group">
        <button class="font-bold text-slate-700 hover:text-indigo-600 transition-colors">PDF</button>
        <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
          <div class="bg-white rounded-xl border-[3px] border-slate-900 shadow-[var(--shadow-brutalist-md)] p-3 min-w-[200px]">
            {pdfLinks.map(link => (
              <a href={link.href} class="block px-4 py-2 rounded-lg font-medium text-slate-700 hover:bg-rose-50 hover:text-rose-600 transition-colors">
                {link.label}
              </a>
            ))}
          </div>
        </div>
      </div>
      <div class="relative group">
        <button class="font-bold text-slate-700 hover:text-indigo-600 transition-colors">Image</button>
        <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
          <div class="bg-white rounded-xl border-[3px] border-slate-900 shadow-[var(--shadow-brutalist-md)] p-3 min-w-[200px]">
            {imageLinks.map(link => (
              <a href={link.href} class="block px-4 py-2 rounded-lg font-medium text-slate-700 hover:bg-cyan-50 hover:text-cyan-600 transition-colors">
                {link.label}
              </a>
            ))}
          </div>
        </div>
      </div>
      {showBlog && <a href="/blog" class="font-bold text-slate-700 hover:text-indigo-600 transition-colors">Blog</a>}
    </div>

    <button
      id="mobile-menu-toggle"
      class="md:hidden p-2 rounded-lg border-2 border-slate-900 font-bold text-sm"
      aria-label="Toggle menu"
      aria-expanded="false"
    >
      Menu
    </button>
  </nav>

  <div id="mobile-menu" class="hidden md:hidden border-t-2 border-slate-200 bg-white px-6 pb-6">
    <div class="pt-4">
      <p class="font-black text-slate-900 text-sm uppercase tracking-wider mb-2">PDF Tools</p>
      <div class="grid grid-cols-2 gap-2 mb-4">
        {pdfLinks.map(link => (
          <a href={link.href} class="px-3 py-2 rounded-lg font-medium text-sm text-slate-700 hover:bg-rose-50 hover:text-rose-600 transition-colors">
            {link.label}
          </a>
        ))}
      </div>
      <p class="font-black text-slate-900 text-sm uppercase tracking-wider mb-2">Image Tools</p>
      <div class="grid grid-cols-2 gap-2 mb-4">
        {imageLinks.map(link => (
          <a href={link.href} class="px-3 py-2 rounded-lg font-medium text-sm text-slate-700 hover:bg-cyan-50 hover:text-cyan-600 transition-colors">
            {link.label}
          </a>
        ))}
      </div>
      {showBlog && <a href="/blog" class="block px-3 py-2 rounded-lg font-bold text-sm text-slate-700 hover:bg-indigo-50 hover:text-indigo-600 transition-colors">Blog</a>}
    </div>
  </div>
</header>

<script>
  const toggle = document.getElementById('mobile-menu-toggle');
  const menu = document.getElementById('mobile-menu');
  toggle?.addEventListener('click', () => {
    const open = menu?.classList.toggle('hidden') === false;
    toggle.setAttribute('aria-expanded', String(open));
  });

  let preloaded = false;
  document.querySelector('a[href="/remove-background"]')?.addEventListener('mouseenter', () => {
    if (preloaded) return;
    preloaded = true;
    import('@imgly/background-removal').then((m) => m.preload());
  }, { once: true });
</script>
